<div class="table-container p-0 m-0">
  <div class="border rounded shadow-sm overflow-hidden min-h-table">
    <div>
      <div class="d-flex gap-2 p-2">
        <input
          type="search"
          placeholder="Search Event"
          [(ngModel)]="manageSearch.searchByEventName"
          (input)="onSearchChange($event)"
          class="form-control"
          name="searchByEventName"
          id=""
        />
        <input
          type="search"
          placeholder="Search Organizer"
          class="form-control"
          [(ngModel)]="manageSearch.searchByOrganizer"
          (input)="onSearchChange($event)"
          name="searchByOrganizer"
          id=""
        />
        <input
          type="search"
          placeholder="Search by City"
          class="form-control"
          [(ngModel)]="manageSearch.searchByCity"
          (input)="onSearchChange($event)"
          name="searchByCity"
          id=""
        />
        <input
          type="date"
          placeholder="Search by Date"
          class="form-control"
          [(ngModel)]="manageSearch.searchByDate"
          (input)="onSearchChange($event)"
          name="searchByDate"
          id=""
        />
        <!-- <input type="submit" value="Search" class="form-control btn btn-primary" (click)="fetchEvents()" id=""> -->
        <button
          type="submit"
          class="form-control btn btn-primary"
          (click)="fetchEvents()"
        >
          <i class="fas fa-search me-2"></i> Search
        </button>
      </div>
    </div>
    <table class="table table-sm table-hover mb-0">
      <thead class="table-primary">
        <tr>
          <th scope="col" class="text-center">#</th>
          <th scope="col">Event Name</th>
          <th scope="col">Organizer</th>
          <th scope="col">Category</th>
          <th scope="col">Time</th>
          <th scope="col">From</th>
          <th scope="col">To</th>
          <th scope="col">Location</th>
          <th scope="col">CreatedAt</th>
          <th scope="col">Status</th>
          <th scope="col">Action</th>
        </tr>
      </thead>
      <tbody>
        <tr *ngFor="let event of dataSource; let i = index">
          <!-- <th scope="row" class="text-center">{{ i + 1 }}</th> -->
          <th scope="row" class="text-center">{{ (currentPage - 1) * perPage + i + 1 }}</th>
          <td>{{ event?.eventName }}</td>
          <td>{{ event?.organizerDetails?.organizer_name }}</td>
          <td>{{ event?.categoryDetails?.categoryName }}</td>
          <td>{{ event?.eventTime }}</td>
          <td>{{ event?.eventFromDate }}</td>
          <td>{{ event?.eventToDate }}</td>
          <td>{{ event?.fullAddress }}</td>
          <td>{{ event?.createdAt | date: 'yyyy-MM-dd'}}</td>
          <td>
            <span
              class="badge rounded-pill"
              [ngClass]="{
                'bg-secondary': event.status === 'draft',
                'bg-success': event.status !== 'draft'
              }"
            >
              <span style="color: aliceblue;">{{ event.status === "draft" ? "Draft" : "Active" }}</span>
            </span>
          </td>
          <td class="text-center">
            <div class="dropdown">
              <button
                class="btn btn-sm btn-light"
                type="button"
                id="dropdownMenuButton{{ i }}"
                data-bs-toggle="dropdown"
                aria-expanded="false"
              >
                <i class="bi bi-three-dots-vertical"></i>
              </button>
            
              <ul
                class="dropdown-menu dropdown-menu-end"
                [attr.aria-labelledby]="'dropdownMenuButton' + i"
              >
                <li>
                  <span class="dropdown-item" (click)="viewEvent(event)">
                    <i class="bi bi-eye me-2"></i> View
                  </span>
                </li>
                <li>
                  <span class="dropdown-item" (click)="editEvent(event)">
                    <i class="bi bi-pencil-square me-2"></i> Edit
                  </span>
                </li>
                <li>
                  <span class="dropdown-item" (click)="activeEvent(event)">
                    <i class="bi bi-toggle-{{ event.status === 'draft' ? 'on' : 'off' }} me-2"></i>
                    {{ event.status === "draft" ? "Make Active" : "Make Draft" }}
                  </span>
                </li>
                <li>
                  <span
                    class="dropdown-item text-danger"
                    (click)="deleteEvent(event)"
                  >
                    <i class="bi bi-trash me-2"></i> Delete
                  </span>
                </li>
              </ul>
            </div>
            
          </td>
        </tr>
      </tbody>
    </table>
  </div>

  <!-- Pagination & Total Count (unchanged) -->
  <nav aria-label="Page navigation" *ngIf="totalPages > 1" class="mt-3">
    <ul class="pagination justify-content-center">
      <!-- Previous -->
      <li class="page-item" [class.disabled]="currentPage === 1">
        <div
          class="page-link"
          (click)="changePage(currentPage - 1)"
          aria-label="Previous"
        >
          <span aria-hidden="true">&laquo;</span>
        </div>
      </li>

      <!-- Page Numbers -->
      <li
        class="page-item cursor-pointer"
        *ngFor="let page of [].constructor(totalPages); let i = index"
        [class.active]="currentPage === i + 1"
      >
        <div class="page-link cursor-pointer" (click)="changePage(i + 1)">
          {{ i + 1 }}
        </div>
      </li>

      <!-- Next -->
      <li
        class="page-item cursor-pointer"
        [class.disabled]="currentPage === totalPages"
      >
        <div
          class="page-link"
          (click)="changePage(currentPage + 1)"
          aria-label="Next"
        >
          <span aria-hidden="true">&raquo;</span>
        </div>
      </li>
    </ul>
  </nav>

  <div class="mt-2">Total Events: {{ totalItems }}</div>
</div>
